The Collegiate Penetration Testing Competition, or CPTC for short, is a penetration testing competition designed to emulate the feel of an actual engagement in the form of a competition between colleges worldwide. This makes it different from many other offensive security related competitions out there; they mostly CTF-like in nature and place a heavy emphasis on the technical skill of the participants. However, CPTC differs from these by providing a corporate network with scoring not just based on the technical findings of participants, but also their report writing and general skills in dealing with clients. There are multiple regions, 5 in the United States, 1 in Canada, 1 in Europe, and 1 in the Middle East. My team, representing Cal Poly Pomona, was a part of the Western region of the United States. 

[Picture of cptc]

## An Overview of the Competition

Competitors apply by first submitting a response to an RFP that the fictional company creates; the company this year was Lebonbon Croissant (LBC), a candy and croissant chain based in France. About three weeks after this, teams of 6 main competitors and 2 alternates representing their respective university are selected and the Open Source Intelligence (OSINT) phase of the competition begins. This phase lasts until the global round of the competition, and during this phase, the organizers create posts online under the identities of people working at or related to LBC. This can be everything from tweeting arbitrary jokes and puns, to leaking infrastructure details through a question posted on Stack Overflow, and even leaking complete databases on Pastebin-like websites. The information found during this phase can assist in the upcoming rounds of the competition, either directly in the engagement, or as an issue to address during the report. Around November is the regional round, where each region performed an engagement against LBC. Historically there were around 20 machines in the network, but this year there was only 12. There is an initial 10 hour session to find as many findings as possible, followed by a 6 hour session for report writing. During the engagement, business tasks, known as injects, would be emailed to us. These tasks would be things such as detailing the security posture of LBC relative to other companies, based on the current findings we had at the time. For both of these rounds, only the main roster of a team could participate.

[LBC Website]

Two months after this is the global round, in which the top team of each region gets to participate. Additionally, the top 7 teams after those are included as wildcard participants, for a total of 15 teams participating. This round is arguable less taxing the the regional round because the re-engagement is two days, with an approximately 8 hour engagement session for each day. A presentation is also included with the report this round, and these deliverables are due at the end of the second day. Historically there have been multiple subnets during the global round, totalling around 30 machines, but this year there was only 1 subnet with the same amount of machines as the regional round. Additionally, like in regionals, there were also injects.

[Pic of cptc in person]

 Participation was hybrid due to COVID-19, with around four or so of the competing teams actually being able to make it to the RIT Campus. For us online participants, we had to stay in a Zoom breakout room with a room monitor and our cameras on. Periodically, volunteers acting as apart of LBC's employees such as Wilma Wonka, the President , or Jim Joseph, the Principal Security Engineer, would enter the room and ask us questions or give us additional tasks. These interactions and responses contributed to the inject score.

[Pic of us presenting]

The overall score from the regional round and the global round differs due to the addition of the presentation, but overall, there was a heavy emphasis on the business aspect of penetration testing this year. The ideology behind this was, if a consulting agency cannot properly communicate the security posture of a client to them, then their technical skill is irrelevant. Additionally, while reporting vulnerabilities is important, not being able to detail the remediation of them to executives makes the consultants much less useful to the client.

[pic of scoring]

## Results and Benefits

At the end of the regional round our team placed first, and this was the same for the global round. This was a first in the history of the competition; up until this point, Cal Poly Pomona's highest placing was second place regionally and third globally. Considering how there was only one returning member from the previous year's team, our captain, Alex, this is an achievement that we have been very proud of. For me, as a freshman that joined the team with zero experience, and I mean that in the complete definition of it, this was an amazing achievement. 

[cp.tc global hall of fame]

Being a unique competition, CPTC is an excellent subject to include within one's resume or during interviews. There is a heavy focus on CTF's and technical experience, but the business aspect of the industry, such as report writing or communication with clients, is overlooked when considering the requirements for a job in the field. This competition provides an excellent mixture of technical and business skills. Additionally, following the competition, participants have the opportunity to talk to the sponsors of the event; a great networking opportunity.

[cp.tc sponsors]

## Preparation

Preparation for this competition began with Alex and Brice in the summer, the former our captain and the latter a veteran and alumni from last year. They created a CPTC bootcamp, a tradition that began last year. However, compared to last year's, this year's bootcamp was significantly improved. More about the bootcamp can be found in Alex's blog, but, to summarize, the basics  of the penetration testing cycle was introduced to us, with hands-on activities and resources being given out as assignments. At the end of the bootcamp was a tryout in which 3 vulnerable machines created by the two were given to all of us, and we had two days to make findings and create a writeup. This was essentially a recreation of the CPTC environment with CTF elements from sites such as HackTheBox. Participation, completion of the aforementioned assignments, and the results of the tryout determined who made the team. Luckily, despite my initial lack of experience, I was able to barely catch up to the curve and landed one of the last spots on the team. 

[pic of tryout environment]

After the tryouts, there was a massive shift in focus to business skills. All of us but Alex had experience in the competition, and he already gauged our current technical standings and projected our growth such that we wouldn't need to spend meetings to focus on that. Technical skills practice was an implicit duty of ours to practice in our own time, and with such a great team chemistry, we completely trusted each other on this duty. For our weekly Saturday meetings we mainly focused on report writing, with the weeks towards the global round integrating a focus on presentation. Reflecting on our reports from previous years, we could see there was a large path in front of us for fixing our reports. Taking inspiration from reports of previous years that the CPTC organizers publicly released, along with publicly available reports and Alex's notes from his internship at Mandiant, we began producing the ultimate report template. While we only met on Saturdays for about 4 hours, many of us worked on the report at home too. 

[Pic of dinobank template]

Alex spent an incredible amount of time perfecting our template to the last detail, and due to that, I was able to catch up technically. Recall that I had no experience when the CPTC bootcamp began; even by the team was selected, I was behind technically by a significant margin. I still struggled with basic methodology and I didn't want to focus on  business, because what use would any business skills be if I couldn't find a finding or understand one? My solution was Hack The Box, a CTF platform that hosts virtual machines that you boot up and attempt to root with a predetermined path that you must discover on your own. During the tryouts I had 4 boxes completed, all of the "Easy" difficulty, and each taking me well over 12 hours distributed over the course of some days. I began attempting boxes daily, first being able to do about one or two a week. Noticing my passion, my other teammates and Brice also helped me on my journey to catch up. By month following the tryouts I was able to conquer about a total of 10 boxes and began creating my own methodology for pentesting. Fast forward to the regional round and I had around taken down 40 boxes. 2 months later in the global round I conquered more than 80. With this I was able to catch up to the technical curve of the team.

[HTB Logo]

While I didn't purely focus on business skills, I did make attempts to improve on them. Firstly, presentations; we had all expected to make it to the global round, and with a presentation being a significant part of the scoring that we lacked last year, we needed a lot of work. Especially me, because I was terrible at presenting due to social anxiety and doubts in my own skill and understanding of material. With a rapidly improving technical skill, I naturally adjusted and became more comfortable with presenting. Due to my involvement with the SWIFT (Students with an Interest in the Future of Technology) club on campus, I was able to have opportunities to present on pentesting related topics, which indirectly improved my ability to present. As for report writing, the weekly practices helped me understand the nature of the report, but at regionals I held back the team due to many minor errors such as passive voice and heavily technical sentences. With over 50 pages in our regional report, I only managed to significantly contribute to about two of them. However, after reflecting on our regional report after the competition and experiencing report writing on the competition first-hand, I became more adjusted to it. I practiced some more report writing with creating Hack The Box writeups and writing about hypothetical findings on the LBC network. By the globals round I had signifcantly improved and I wasn't such a liability to the team anymore.

[picture of swift presentation]

## OSINT

The OSINT this year was dry ... or at least we thought so. Initially we found the low hanging fruit; four Twitter accounts belonging to Wilma, Jim, Slugworth, and LBC. Soon we found Jim leaking some infrastructure on Stack Overflow by posting a question that included API documentation. Additional findings were Linkedin profiles, Instagram posts, and a Github repository that contained some infrastructure information. The significant findings we could determine were that there was going to be an Opencart service and Swagger API running. There were some oddly emphasized words in some of Wilma's tweets, so we noted them down as potential passwords, and an Instagram post from the LBC account had the words "Golden Ticket" and "Lollipops" in French, so we also noted it. However, none of this turned out directly useful. None of the potential passwords or notes turned out to be on the environment, and while Opencart and Swagger API were found on the environment, we couldn't find a vulnerability on either of them before or during the competition. However, we were able to include the Swagger API documentation as a finding within our report, but that was the only finding we could get out of the OSINT this season.

[Maltego graph]

While OSINT may have seemed dry, after talking with the organizers after the competition, it turns out it wasn't. We missed something incredibly simple on the Stack Overflow; there was an edit made by a user "Helen", and by clicking the "edited Oct 9 '21 at 9:39" instead of Helen's username (which I didn't think made a difference), a more significant finding was revealed: the full documentation for the API was posted by Jim, revealing many endpoints. While not everything was revealed, since the organizers plan on reusing some of the undiscovered OSINT, it was also mentioned that the entire customer database of LBC was uploaded on some pastebin or a related website. 

[swagger api documentation that we missed]

Several weeks before the regional round we were heavily convinced OSINT was dry this season, so we switched gears and placed extra emphasis on the report template during our weekly meetings. While contributed to our first place in the report category, it is also a reminder to us that our OSINT needs some heavy work.

## The Regional Round

The regional round occurred on 11/13/21, and due to being oriented around the organizer's time zone, Eastern Time, we had to wake up and arrive at our workstation, the Telco Lab, by 5:45 A.M. To say we were nervous was an understatement. Of the 6 participating team members, only Alex, our captain, had any sort of direct experience with the competition until that point. While he actively and repeatedly vouched for our preparedness during the preceding months, we still were incredibly nervous. A person's words can only go so far until you experience the real thing. When the environment opened up to us, we spun up Jvis, which is a recoded version of nVis. jVis was created by Nathan and serves as a centralized, collaborative framework for nmap scans, and nVis was served the same purpose but had a cluttered UI.

[jvis picture]

We quickly identified the network and were surprised that there was only around 10 machines or so. We made some findings quite quickly, with Robinson finding unauthorized access to a PostgreSQL database containing information that violated PCI-DSS compliance rules. Abusing this version of PosgreSQL, we were able to get a foothold but not much else on the machine. I managed to find unauthorized access to GitLab hosted on one of the machines and Alex found out Grafana was also running using SSO from GitLab. After this, we were very stumped. These findings significantly raised our morale within the first hour, but the following hours were very rough. We couldn't escalate privileges from our initial shell on the PostgreSQL machine, and aside from unauthenticated VNC access on the Windows machine, unauthenticated API access, and a NetJukeBox server with default credentials, we couldn't make many more significant findings. The Windows machines seemed impenetrable as they lacked many services and brute forcing was unsuccessful. The other findings previously mentioned didn't seem to make any significant leads in our attempts to compromise the network. However, a bit past the halfway point, Gabriel managed to find access to ScadaBR, an Industrial Control System (ICS) that was also vulnerable to an exploit that granted us code execution, giving us our second shell. While that raised our morale, that was the last finding we made. Between then and the closing of the environment, our morale drained, and we began losing focus, constantly repeating mindless scans and fruitless exploitation attempts. However, Alex remained undaunted and cleanly answered all of the incoming injects and fought hard to keep our team's focus and mental together. 

[pic of regional subnet]

Once the environment closed, we had about 6 hours to write our report. While we had many things prewritten with our report template, with such little findings compared to last year, we felt very demoralized. We spent about 15 minutes or so eating donuts that we brought and were partially revitalized with some encouragement from Alex. We got cracking on the report, and with much of it already finished, our moral gradually returned. We were able to quickly complete a rough draft of the report with over two hours to spare, although much of that time was me constantly rewriting my findings because my writing skills and style didn't match the rest of the report. We ended the day feeling mixed; while we were proud of our report and finished it with much time to review it compared to last year, we heavily anticipated a rough outcome due to our lack of findings.

[pic of our findings by risk category]

The next day we were on complete edge. A very strong report countered with a lack of findings. While Alex attempted to reassure us, deep down we were all very nervous. When the organizers were announcing the top 3 teams, with the third being Cal State Fullerton, my heart dropped for a second, believing that we did worse than last year. When they were revealing the second place team, the suspense within all of us nearly went up tenfold. The organizers described how tight it was, how the score difference between first and second place was less than 1%, or 1 point. This suspense continued for a few minutes before it was revealed that Stanford was second place, and then they quickly revealed that we were first place. Managing to beat Stanford was nice due to the reputation of the university, but being first in the region for the first time in the competition's history was an incredible feeling. Our fears, while well-warranted, turned out to be completely false, and we managed to obtain a result comparable to the endless hours we each spent preparing. Additionally, by placing first in our region, a spot in the global round was secure, allowing us to sleep well that night.

[cptc #1 regional tweet]

## Interim

Riding the victory high, we all rested for a bit, especially because finals week was coming up soon. Additionally, many of us on the CPTC team, including me, were also participating in the Collegiate Cyber Defense Competition (CCDC), which could be described as the more popular counterpart to CPTC. While we typically held the practices one after the other on Saturdays, the first invitational round for this competition was the week following CPTC so we held off on CPTC practice, and then Thanksgiving followed so we held off on practice for the holidays. The second round of CCDC was on the 10th of December, causing us to once again skip practice. Once that was over, the 8 weeks between the regional and global competition turned to a mere 3.5 weeks. The victory high quickly eroded and we dove into nervousness once again. This was especially notable from Alex as he had been wanting to fix up on the issues we faced in regionals, but the holidays and CCDC came into our way. In the remaining weeks we began meeting up twice instead of just on Saturday, focusing on more of the same, but also focusing on the presentation element of the global round. As for me, I continued doing Hack The Box to hide from the stress of the upcoming round. When the global round arrived, our report template was beefed up a bit, our anxiety revived, and our skills refined.

## The Global Round



